ğŸ¯ Objective Analyze:
Demand trends
Fast-moving products
Slow-moving products
Seasonal demand
Future demand preparation

-- ğŸŸ¢ Stage 1 â€” Demand Analysis
-- âœ… TASK 1 -â“ Monthly Demand per Product
select product_id, date_format(order_date,'%Y-%m') as monthly,
	sum(quantity) as sales
from orders
group by product_id, monthly
order by product_id, monthly;

-- ğŸŸ¢ TASK 2 --â“ Most Demanded Products
select product_id, sum(quantity) as sales
from orders
group by product_id
order by sales  desc;

-- ğŸŸ¢ TASK 3 -â“ Least Demanded Products
select product_id, sum(quantity) as sales
from orders
group by product_id
order by sales;

-- ğŸŸ¢ Stage 2 â€” Trend Analysis
-- âœ… TASK 4 -â“ Running Demand Trend
select order_date, sum(quantity) as daily_demand,
	sum(sum(quantity)) over (order by order_date) as cum_demand
from orders
group by order_date;

-- ğŸŸ¢ TASK 5 - â“ Demand Growth
select order_date, sum(quantity) as demand,
	LAG(sum(quantity)) over (order by order_date) as pre_demand
from orders
group by order_date;

-- ğŸŸ¢ Stage 3 â€” Inventory Thinking
-- âœ… TASK 6 - â“ Fast Moving Products
select product_id, avg(quantity) as avg_sales
from orders
group by product_id
order by avg_sales desc;

-- ğŸŸ¢ TASK 7 -â“ Slow Moving Products
select product_id, avg(quantity) as avg_sales
from orders
group by product_id
order by avg_sales;

-- ğŸŸ¢ Stage 4 â€” Forecast Preparation
-- âœ… TASK 8 - â“ Monthly Trend Table
select date_format(order_date,'%Y-%m') as monthly, sum(quantity) as monthly_sales
from orders
group by monthly;

-- ğŸŸ¢ Stage 5 â€” Advanced Analytics
-- âœ… TASK 9 - â“ Top 5 Growing Products

select * from (
	select o.product_id, sum(o.quantity) as qty, p.product_name,
		dense_rank() over (order by sum(o.quantity) desc) as top_list
	from orders o
    join products p
    on o.product_id=p.product_id
    group by o.product_id) sp
where top_list<=5;
